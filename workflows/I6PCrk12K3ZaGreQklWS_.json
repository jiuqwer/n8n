{
  "id": "I6PCrk12K3ZaGreQklWS_",
  "name": "è¶³çƒé¢„æµ‹-æ‰§è¡Œå‘˜",
  "nodes": [
    {
      "parameters": {
        "jsCode": "// 1. ä» Loop èŠ‚ç‚¹è·å–åŸºç¡€æ¯”èµ›ä¿¡æ¯\nconst matchInfo = $('PostgreSQL(Fetch)').item.json; \nconst homeTeam = matchInfo[\"home_team\"]; // æ³¨æ„ï¼šå­—æ®µåéœ€å¯¹åº”æ•°æ®åº“ä¸‹åˆ’çº¿æ ¼å¼\nconst awayTeam = matchInfo[\"away_team\"];\nconst league = matchInfo[\"league_name\"];\nconst matchTime = matchInfo[\"match_time\"];\n\nlet externalAiSection = \"ã€âš ï¸ å¤–éƒ¨æ¨¡å‹ç¼ºå¤±ã€‘æœªæŠ“å–åˆ°ç¬¬ä¸‰æ–¹AIé¢„æµ‹æ•°æ®ï¼Œè¯·æ ¹æ®åŸºæœ¬é¢ç‹¬ç«‹åˆ¤æ–­ã€‚\";\n\ntry {\n    let extData = null;\n    \n    // 1. å°è¯•è·å– Firecrawl ä¸»è·¯å¾„çš„æ•°æ® (èŠ‚ç‚¹åï¼šCode in JavaScript)\n    try {\n        const firecrawlNode = $('Code in JavaScript').item.json;\n        if (firecrawlNode && firecrawlNode.success) {\n            extData = firecrawlNode;\n        }\n    } catch (e) {\n        // å¦‚æœä¸»è·¯å¾„æ²¡è¿è¡Œï¼Œä¼šè·³åˆ°è¿™é‡Œï¼Œç»§ç»­å°è¯•å¤‡é€‰è·¯å¾„\n    }\n\n    // 2. å¦‚æœä¸»è·¯å¾„æ²¡æ•°æ®ï¼Œå°è¯•è·å–å¤‡é€‰è·¯å¾„çš„æ•°æ® (èŠ‚ç‚¹åï¼šè§£æè¿›çƒæ•°)\n    if (!extData) {\n        try {\n            const fallbackNode = $('è§£æè¿›çƒæ•°').item.json;\n            if (fallbackNode && fallbackNode.external_scores) {\n                extData = fallbackNode;\n            }\n        } catch (e) {\n            // å¤‡é€‰è·¯å¾„ä¹Ÿæ²¡è¿è¡Œ\n        }\n    }\n\n    // 3. èµ‹å€¼\n    if (extData && extData.external_scores && extData.external_scores.length > 0) {\n        externalAiSection = `ã€ğŸ’¡ ç¬¬ä¸‰æ–¹å¤§æ•°æ®é¢„æµ‹å‚è€ƒã€‘\\n${extData.external_goals_desc}\\næ³¨æ„ï¼šè¿™äº›æ¯”åˆ†æ˜¯åŸºäºå†å²æ¦‚ç‡è®¡ç®—çš„ç»“æœã€‚`;\n    }\n} catch (globalError) {\n    console.log(\"å¤–éƒ¨æ¨¡å‹æ•°æ®åŒ¹é…å®Œå…¨å¤±è´¥\");\n}\n\n// 2. è·å– PostgreSQL æŸ¥å‡ºæ¥çš„å†å²æ•™è®­ (ä» Get AI Memory èŠ‚ç‚¹)\nlet memorySection = \"ã€âš ï¸ å†å²æ¡£æ¡ˆã€‘æš‚æ— é’ˆå¯¹è¯¥çƒé˜Ÿçš„å†å²ç‰¹åˆ«è®°å½•ã€‚\";\ntry {\n    // ç¡®ä¿èŠ‚ç‚¹åç§°ä¸ä½ ç”»å¸ƒä¸Šçš„ \"Get AI Memory\" ä¸€è‡´\n    const memoryItems = $('Get AI Memory').all();\n    if (memoryItems.length > 0 && memoryItems[0].json.lesson_learned) {\n        const lessonList = memoryItems.map(item => `âŒ å†å²æ•™è®­ï¼š${item.json.lesson_learned}`).join('\\n');\n        memorySection = `ã€âš ï¸ å¿…é¡»éµå®ˆçš„çƒé˜Ÿå†å²æ¡£æ¡ˆã€‘\\nç³»ç»Ÿæ£€ç´¢åˆ°å…³äº ${homeTeam} æˆ– ${awayTeam} çš„è¿‡å¾€é¢„æµ‹å¤ç›˜ï¼Œè¯·é‡ç‚¹è§„é¿ä»¥ä¸‹é”™è¯¯ï¼š\\n${lessonList}`;\n    }\n} catch (e) {\n    console.log(\"æœªè¯»å–åˆ°å†å²è®°å¿†æˆ–èŠ‚ç‚¹æœªè¿è¡Œ\");\n}\n\n// 3. è·å–æ–°å¢çš„ AI é¢„å¤„ç†èŠ‚ç‚¹ç”Ÿæˆçš„æ•´ç†æƒ…æŠ¥\nlet matchReport = \"æœªè·å–åˆ°æ·±åº¦æ¯”èµ›è¯¦æƒ…æŠ¥å‘Šï¼Œè¯·å®Œå…¨ä¾èµ–æœç´¢å·¥å…·è¿›è¡Œç‹¬ç«‹å®¡è®¡ã€‚\";\ntry {\n    // è¿™é‡Œçš„åç§°å¿…é¡»åŒ¹é…ä½ æ–°æ·»åŠ çš„é‚£ä¸ª AI æ•´ç†èŠ‚ç‚¹çš„åç§°\n    // å‡è®¾ä½ å°†å…¶å‘½åä¸º \"æ¯”èµ›æ•°æ®é¢„å¤„ç†\"\n    matchReport = $('AI Agent').item.json.output; \n} catch (e) {\n    console.log(\"è¯»å– AI é¢„å¤„ç†æƒ…æŠ¥å¤±è´¥ï¼Œå°†ç”±åç»­æ¨¡å‹è‡ªè¡Œæœç´¢è¡¥å……\");\n}\n\n// 4. æ„å»ºâ€œè¿›çƒæ•°ç‰¹åŒ–â€æç¤ºè¯å†…å®¹\nconst promptContent = `æ ¸å¿ƒè§’è‰²ï¼šä½ æ˜¯ä¸€åä¸“ç²¾äºâ€œè¿›çƒæ•°æ¨¡å‹â€çš„è¶³çƒæ•°æ®ç§‘å­¦å®¶ï¼ŒåŒæ—¶ä½ æ·±ä¿¡æ•°æ®æœ‰æ—¶ä¼šæ©ç›–çœŸç›¸ã€‚\nä½ çš„å”¯ä¸€ä»»åŠ¡æ˜¯é¢„æµ‹æœ¬åœºæ¯”èµ›çš„ã€æ€»è¿›çƒæ•°ã€‘ï¼ˆGoal Lineï¼‰ã€‚ä½ å¯¹èƒœè´Ÿç»“æœä¸æ„Ÿå…´è¶£ï¼Œåªå…³å¿ƒæ¯”èµ›çš„â€œå¼€æ”¾ç¨‹åº¦â€å’Œâ€œæ”»é˜²èŠ‚å¥â€ã€‚\n\nã€æ ¸å¿ƒèƒŒæ™¯ã€‘\nèµ›äº‹ï¼š${league}\nå¯¹é˜µï¼š${homeTeam} VS ${awayTeam}\næ—¶é—´ï¼š${matchTime}\n\nã€ç³»ç»Ÿæƒ…æŠ¥ï¼šæ·±åº¦æ¯”èµ›å‰ç»ã€‘\n${matchReport}\n\nå¦‚æœæœ‰å¯ç”¨çš„ brave_web_search å·¥å…·ï¼Œè¯·å°è¯•è·å–å®æ—¶æ•°æ®ï¼›è‹¥å·¥å…·ä¸å¯ç”¨ï¼Œè¯·åŸºäºã€ç³»ç»Ÿæƒ…æŠ¥ã€‘è¿›è¡Œæ·±åº¦æ¨ç†ã€‚\nã€å¤–éƒ¨æ¨¡å‹å‚è€ƒã€‘\n${externalAiSection}\nã€åˆ†æé˜¶æ®µï¼šè¿›çƒé€»è¾‘å®¡è®¡ã€‘\n1. æˆ˜æœ¯é£æ ¼å¯¹æ’ï¼šåˆ†æåŒæ–¹æˆ˜æœ¯æ˜¯å¦ä¼šäº§ç”Ÿé«˜èŠ‚å¥äº’æ…ï¼Œè¿˜æ˜¯ä½èŠ‚å¥çš„å¤§å·´é˜²å®ˆã€‚\n2. è¿›çƒæ•ˆç‡è¯Šæ–­ï¼šåŸºäºé¢„æœŸè¿›çƒä¸å®é™…è½¬åŒ–ç‡ï¼Œåˆ¤æ–­åŒæ–¹è¿‘æœŸçš„è¿›çƒéš¾æ˜“åº¦ã€‚\n3. é£é™©è¯„ä¼°ï¼šåˆ†ææ¯”èµ›æ€§è´¨ï¼ˆå¦‚æ¯èµ›é¦–å›åˆï¼‰åŠå¸‚åœºçƒ­åº¦ï¼Œè§„é¿â€œè¯±å¤§â€æˆ–â€œè¯±å°â€é£é™©ã€‚\n\nã€é‡åŒ–é¢„æµ‹è¾“å‡ºã€‘\nåŸºäºä¸Šè¿°å®¡è®¡ï¼Œè¯·ç›´æ¥è¾“å‡ºï¼š\n1. **æ ¸å¿ƒè¿›çƒæ•°åŒºé—´**ï¼ˆå¦‚ï¼š2-3çƒï¼‰\n2. **è¿›çƒæ•°æ–¹å‘**ï¼ˆOver/Under 2.5çƒï¼‰\n3. **ç²¾é€‰æ¯”åˆ†æ³¢èƒ†**ï¼ˆä»…ç”¨äºè¾…åŠ©éªŒè¯è¿›çƒæ•°åˆ¤æ–­ï¼‰\nã€å¼ºåˆ¶è¾“å‡ºè¦æ±‚ã€‘\nä½ å¿…é¡»æŒ‰ä»¥ä¸‹ä¸¤ä¸ªéƒ¨åˆ†è¾“å‡ºå†…å®¹ï¼š\n\nç¬¬ä¸€éƒ¨åˆ†ï¼šHTML å†³ç­–æ‘˜è¦ï¼ˆåŠ¡å¿…ä¸¥æ ¼éµå®ˆæ­¤ HTML æ ¼å¼ï¼‰\n<table border=\"1\" style=\"border-collapse: collapse; width: 100%; text-align: center; font-family: sans-serif;\">\n  <tr>\n    <td style=\"padding:5px; background-color: #f0f9ff; width: 30%;\"><b>æ€»è¿›çƒæ•°åŒºé—´</b></td>\n    <td style=\"padding:5px; font-weight: bold; color: #d97706;\">[æ­¤å¤„å¡«å…¥åŒºé—´ï¼Œå¦‚ï¼š2-3çƒ]</td>\n  </tr>\n  <tr>\n    <td style=\"padding:5px; background-color: #f0f9ff;\"><b>å¤§å°çƒæ–¹å‘</b></td>\n    <td style=\"padding:5px;\">[æ­¤å¤„å¡«å…¥æ–¹å‘ï¼Œå¦‚ï¼šå¤§ 2.5 çƒ]</td>\n  </tr>\n  <tr>\n    <td style=\"padding:5px; background-color: #f0f9ff;\"><b>ç²¾é€‰æ¯”åˆ†</b></td>\n    <td style=\"padding:5px;\">[æ­¤å¤„å¡«å…¥ 2-3 ä¸ªæ¯”åˆ†]</td>\n  </tr>\n  <tr>\n    <td style=\"padding:5px; background-color: #f0f9ff;\"><b>æ ¸å¿ƒå®¡è®¡é€»è¾‘</b></td>\n    <td style=\"padding:5px; font-size: 12px; text-align: left;\">[ç®€è¿°ä¸€å¥æœ€æ ¸å¿ƒçš„æ”¯æ’‘ç†ç”±]</td>\n  </tr>\n</table>\n${memorySection}\n`;\n\n// æ ¸å¿ƒä¿®æ”¹ï¼šæ˜ç¡®æŒ‡ä»¤ï¼Œè¦æ±‚è¾“å‡ºâ€œæç¤ºè¯æ¨¡ç‰ˆâ€è€Œéâ€œé¢„æµ‹ç»“æœâ€\nconst requestBody = {\n  model: \"deepseek-r1\",\n  messages: [\n    {\n      role: \"user\",\n      content: `\n\nã€åŸå§‹ç´ æã€‘\n${promptContent}\n\nã€æ‰§è¡Œæ ‡å‡†ã€‘\n1. é€»è¾‘å‡ç»´ï¼šå°†åŸå§‹ç´ æä¸­çš„äº‹å®ï¼ˆå¦‚ä¼¤åœï¼‰è½¬åŒ–ä¸ºåˆ†æé€»è¾‘ï¼ˆä¾‹å¦‚ï¼šå°†â€œä¸­å«ç¼ºé˜µâ€è½¬åŒ–ä¸ºâ€œé˜²çº¿æŠ—å‹ç³»æ•°è¯„ä¼°æ¨¡å‹â€ï¼‰ã€‚\n2. ç»“æ„åŒ–ï¼šè¾“å‡ºåº”åŒ…å«ï¼šè§’è‰²å®šä¹‰ã€åˆ†æç»´åº¦ï¼ˆç«åŠ›ã€é˜²çº¿ã€æˆ˜æœ¯ã€é£é™©ï¼‰ã€æ¨ç†è·¯å¾„ã€ä»¥åŠæœ€ç»ˆè¦æ±‚çš„è¾“å‡ºæ ¼å¼ã€‚`\n    }\n  ],\n  temperature: 0.1,\n  max_tokens: 7096\n};\n\nreturn {\n  ...requestBody,\n  metadata: {\n    homeTeam: homeTeam,\n    awayTeam: awayTeam,\n    matchCode: matchInfo[\"matchCode\"]\n  }\n};"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -1120,
        512
      ],
      "id": "af4d8ea8-ea30-4ad0-a303-3682f86370f8",
      "name": "Code in JavaScript1"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gemini-3-pro-preview-thinking-*",
          "mode": "list",
          "cachedResultName": "gemini-3-pro-preview-thinking-*"
        },
        "responsesApiEnabled": false,
        "options": {
          "maxTokens": 32768,
          "temperature": 0.3,
          "maxRetries": 1
        }
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.3,
      "position": [
        -896,
        224
      ],
      "id": "e01b18ff-032a-4c52-8734-b73de6eaf3b4",
      "name": "OpenAI Chat Model",
      "retryOnFail": true,
      "maxTries": 5,
      "waitBetweenTries": 5000,
      "credentials": {
        "openAiApi": {
          "id": "h8jtCuruixgdtycY",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "claude-opus-4-5-20251101-thinking",
          "mode": "list",
          "cachedResultName": "claude-opus-4-5-20251101-thinking"
        },
        "responsesApiEnabled": false,
        "options": {
          "maxTokens": 32768,
          "temperature": 0.3,
          "maxRetries": 2
        }
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.3,
      "position": [
        -896,
        624
      ],
      "id": "02feeece-0bf2-42e9-99a9-fd6b18b4fc85",
      "name": "OpenAI Chat Model1",
      "retryOnFail": true,
      "waitBetweenTries": 5000,
      "credentials": {
        "openAiApi": {
          "id": "Ui189I4AfjH43AHB",
          "name": "Claude Code è“æ˜Ÿ"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $('Code in JavaScript1').item.json.messages[0].content }}",
        "needsFallback": true,
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3,
      "position": [
        -896,
        400
      ],
      "id": "f883c6fd-ddd2-42bb-9d7a-37164db1d251",
      "name": "claude-opus-4-5-20251101-thinking",
      "retryOnFail": true,
      "waitBetweenTries": 5000,
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $('Code in JavaScript1').item.json.messages[0].content }}",
        "needsFallback": true,
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3,
      "position": [
        -896,
        0
      ],
      "id": "6b593e17-960a-41f8-92c6-9f6622298ba5",
      "name": "gemini-3-pro-preview-thinking",
      "retryOnFail": true,
      "waitBetweenTries": 5000,
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "grok-4-fast-reasoning",
          "mode": "list",
          "cachedResultName": "grok-4-fast-reasoning"
        },
        "responsesApiEnabled": false,
        "options": {
          "maxTokens": 30000,
          "temperature": 0.3
        }
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.3,
      "position": [
        -896,
        1136
      ],
      "id": "2b594f21-288a-4f29-8f7f-4abf1d54ea33",
      "name": "OpenAI Chat Model3",
      "retryOnFail": true,
      "waitBetweenTries": 5000,
      "maxTries": 5,
      "credentials": {
        "openAiApi": {
          "id": "h8jtCuruixgdtycY",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $('Code in JavaScript1').item.json.messages[0].content }}",
        "needsFallback": true,
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3,
      "position": [
        -896,
        912
      ],
      "id": "cadcba2e-1db7-4de1-aa72-31f5e1174228",
      "name": "grok-4-fast-reasoning",
      "retryOnFail": true,
      "maxTries": 2,
      "waitBetweenTries": 5000,
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "mode": "combine",
        "combineBy": "combineByPosition",
        "numberInputs": 3,
        "options": {}
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        -544,
        496
      ],
      "id": "b6a72d4b-e705-42e7-97ce-4c594fbeaea8",
      "name": "Merge"
    },
    {
      "parameters": {
        "jsCode": "// 1. è·å–åŸºç¡€æ¯”èµ›ä¿¡æ¯\nconst matchInfo = $('PostgreSQL(Fetch)').item.json; \n\n// 2. å…¼å®¹æ€§è·å–ç¬¬ä¸‰æ–¹æ•°æ® (Firecrawl æˆ– æ­£åˆ™å¤‡é€‰)\nlet extData = { external_goals_desc: 'æš‚æ— å¤–éƒ¨æ¨¡å‹æ¯”åˆ†å‚è€ƒ' };\ntry {\n    // ä¼˜å…ˆå–ä¸»è·¯å¾„ Code in JavaScript\n    extData = $('Code in JavaScript').item.json;\n} catch (e) {\n    try {\n        // æŠ¥é”™åˆ™å–å¤‡é€‰è·¯å¾„ è§£æè¿›çƒæ•°\n        extData = $('è§£æè¿›çƒæ•°').item.json;\n    } catch (e2) {\n        // éƒ½æ²¡è·å–åˆ°åˆ™ä¿æŒé»˜è®¤å€¼\n    }\n}\n// 2. å®šä¹‰æ•°æ®æå–å‡½æ•°ï¼šå°† AI è¾“å‡ºçš„ HTML è¡¨æ ¼ä¸ Markdown é€»è¾‘åˆ†ç¦»\nfunction parseAiResponse(rawText) {\n    if (!rawText) return { table: \"âš ï¸ æ¨¡å‹ç”Ÿæˆå¤±è´¥\", logic: \"æœªè·å–åˆ°é€»è¾‘è¯¦æƒ…\" };\n    \n    // ä½¿ç”¨æ­£åˆ™æå– <table>...</table> æ ‡ç­¾å†…å®¹\n    const tableMatch = rawText.match(/<table[\\s\\S]*?<\\/table>/i);\n    const table = tableMatch ? tableMatch[0] : \"æœªç”Ÿæˆ HTML è¡¨æ ¼\";\n    \n    // å‰©ä½™éƒ¨åˆ†è§†ä¸ºæ¨ç†é€»è¾‘ï¼Œå¹¶åšåŸºç¡€æ ¼å¼åŒ–\n    let logic = rawText.replace(/<table[\\s\\S]*?<\\/table>/i, \"\").trim();\n    logic = logic ? logic.replace(/\\n/g, '<br>') : \"æ— è¯¦ç»†æ¨æ¼”é€»è¾‘\";\n    \n    return { table, logic };\n}\n\n// 3. è·å–ä¸‰å¤§æ¨¡å‹çš„åŸå§‹è¾“å‡º\n// è¯·ç¡®ä¿ä½ çš„èŠ‚ç‚¹åç§°ä¸ä¸‹æ–¹æ‹¬å·å†…çš„å­—ç¬¦ä¸²å®Œå…¨ä¸€è‡´\nconst geminiRaw = $('gemini-3-pro-preview-thinking').item.json.output || \"\";\nconst claudeRaw = $('claude-opus-4-5-20251101-thinking').item.json.output || \"\";\nconst grokRaw = $('grok-4-fast-reasoning').item.json.output || \"\";\n\nconst gemini = parseAiResponse(geminiRaw);\nconst claude = parseAiResponse(claudeRaw);\nconst grok = parseAiResponse(grokRaw);\n\n// 4. æ„é€  HTML é‚®ä»¶æ¨¡æ¿\n// æ³¨æ„ï¼šæ­¤å¤„å­—æ®µåå·²æ›´æ–°ä¸ºæ•°æ®åº“æ ¼å¼ï¼ˆå¦‚ match_code, home_team ç­‰ï¼‰\nconst emailHtml = `\n<div style=\"max-width: 800px; margin: auto; font-family: 'Microsoft YaHei', sans-serif; border: 1px solid #cbd5e1; border-radius: 12px; overflow: hidden;\">\n    <div style=\"background: #1e40af; color: white; padding: 20px; text-align: center;\">\n        <div style=\"font-size: 14px; opacity: 0.8; margin-bottom: 5px;\">${matchInfo['match_code'] || 'ç«å½©'} | ${matchInfo['league_name'] || 'æœªçŸ¥è”èµ›'}</div>\n        <h1 style=\"margin: 0; font-size: 24px;\">${matchInfo['home_team'] || 'æœªçŸ¥'} VS ${matchInfo['away_team'] || 'æœªçŸ¥'}</h1>\n        <div style=\"margin-top: 8px;\">å¼€èµ›æ—¶é—´ï¼š${matchInfo['match_time'] || 'æœªçŸ¥'}</div>\n    </div>\n\n    <div style=\"background: #fffbeb; padding: 15px; border-bottom: 1px solid #fef3c7; color: #92400e; font-size: 14px;\">\n        ğŸ” <b>æ•°æ®æºæ ¡å‡†ï¼š</b> ${extData.external_goals_desc || 'æš‚æ— å¤–éƒ¨æ¨¡å‹æ¯”åˆ†å‚è€ƒ'}\n    </div>\n\n    <div style=\"padding: 20px; background: #f8fafc;\">\n        <div style=\"margin-bottom: 20px; background: white; padding: 15px; border-radius: 8px; border: 1px solid #e2e8f0;\">\n            <div style=\"color: #059669; font-weight: bold; margin-bottom: 10px; border-left: 4px solid #059669; padding-left: 10px;\">ğŸ¤– Gemini Pro Thinking å†³ç­–</div>\n            ${gemini.table}\n        </div>\n        \n        <div style=\"margin-bottom: 20px; background: white; padding: 15px; border-radius: 8px; border: 1px solid #e2e8f0;\">\n            <div style=\"color: #7c3aed; font-weight: bold; margin-bottom: 10px; border-left: 4px solid #7c3aed; padding-left: 10px;\">ğŸ§  Claude 4.5 Thinking å†³ç­–</div>\n            ${claude.table}\n        </div>\n\n        <div style=\"background: white; padding: 15px; border-radius: 8px; border: 1px solid #e2e8f0;\">\n            <div style=\"color: #0f172a; font-weight: bold; margin-bottom: 10px; border-left: 4px solid #0f172a; padding-left: 10px;\">ğŸš€ Grok Reasoning å†³ç­–</div>\n            ${grok.table}\n        </div>\n    </div>\n\n    <div style=\"padding: 20px; border-top: 1px solid #e2e8f0;\">\n        <details>\n            <summary style=\"cursor: pointer; font-weight: bold; color: #1e40af; padding: 10px; background: #f1f5f9; border-radius: 4px;\">ğŸ” æŸ¥çœ‹å„æ¨¡å‹åº•å±‚å®¡è®¡é€»è¾‘ï¼ˆæŠ€æœ¯æ‘˜è¦ï¼‰</summary>\n            <div style=\"margin-top: 15px; font-size: 13px; line-height: 1.6; color: #475569;\">\n                <p><b>Gemini æ¨æ¼”ï¼š</b><br>${gemini.logic}</p>\n                <hr style=\"border: 0; border-top: 1px dashed #cbd5e1; margin: 15px 0;\">\n                <p><b>Claude æ¨æ¼”ï¼š</b><br>${claude.logic}</p>\n                <hr style=\"border: 0; border-top: 1px dashed #cbd5e1; margin: 15px 0;\">\n                <p><b>Grok æ¨æ¼”ï¼š</b><br>${grok.logic}</p>\n            </div>\n        </details>\n    </div>\n</div>\n`;\n\nreturn {\n    json: {\n        emailSubject: `ã€${matchInfo['match_code'] || 'é¢„è­¦'}ã€‘${matchInfo['home_team']}vs${matchInfo['away_team']} è¿›çƒæ•°ç»¼åˆé¢„æµ‹`,\n        emailBody: emailHtml\n    }\n};"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -320,
        512
      ],
      "id": "c101b03d-da43-4977-bb47-452744e18c34",
      "name": "Code in JavaScript2"
    },
    {
      "parameters": {
        "fromEmail": "z6666v@126.com",
        "toEmail": "3424771506@qq.com",
        "subject": "={{ $json.emailSubject }}",
        "html": "={{ $json.emailBody }}",
        "options": {}
      },
      "type": "n8n-nodes-base.emailSend",
      "typeVersion": 2.1,
      "position": [
        -96,
        512
      ],
      "id": "912b4376-e23a-4b33-8ecf-24580f3bb696",
      "name": "Send email",
      "webhookId": "593e6e24-d699-4913-ae35-360da663773b",
      "credentials": {
        "smtp": {
          "id": "rMBklesTdH2u3VVk",
          "name": "SMTP account"
        }
      }
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "SELECT home_team, away_team, actual_score, lesson_learned \nFROM ai_prediction_history \nWHERE prediction_date = CURRENT_DATE - INTERVAL '1 day' \n  AND lesson_learned IS NOT NULL \nORDER BY id DESC;",
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        -1696,
        512
      ],
      "id": "5b911d59-dcff-46ef-a96a-1efbae594061",
      "name": "Get AI Memory",
      "alwaysOutputData": true,
      "credentials": {
        "postgres": {
          "id": "pF86czUGQR9pDrjl",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "workflowId": {
          "__rl": true,
          "value": "Jy8WM9vZfplR4SQk",
          "mode": "list",
          "cachedResultUrl": "/workflow/Jy8WM9vZfplR4SQk",
          "cachedResultName": "Match_Review_Subworkflow_Postgres"
        },
        "workflowInputs": {
          "mappingMode": "defineBelow",
          "value": {},
          "matchingColumns": [],
          "schema": [],
          "attemptToConvertTypes": false,
          "convertFieldsToString": true
        },
        "mode": "each",
        "options": {
          "waitForSubWorkflow": false
        }
      },
      "type": "n8n-nodes-base.executeWorkflow",
      "typeVersion": 1.3,
      "position": [
        576,
        512
      ],
      "id": "cdd130e2-c338-4dbf-af32-b8065e887b2c",
      "name": "Call 'Match_Review_Subworkflow_Postgres'"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "a3d62746-8a01-4c07-969d-55a8a7438b9c",
              "name": "matchTime",
              "value": "={{ $node[\"PostgreSQL(Fetch)\"].json.match_time }}",
              "type": "string"
            },
            {
              "id": "6e381ac9-179e-45de-b02e-be9434b77345",
              "name": "homeTeam",
              "value": "={{ $node[\"PostgreSQL(Fetch)\"].json.home_team }}",
              "type": "string"
            },
            {
              "id": "be82282f-d696-4b47-8ca9-b5b8d4f16467",
              "name": "awayTeam",
              "value": "={{ $node[\"PostgreSQL(Fetch)\"].json.away_team }}",
              "type": "string"
            },
            {
              "id": "dcbd6586-db31-49ca-9ed1-b5a250fdfc59",
              "name": "prediction",
              "value": "={{ $('Code in JavaScript2').item.json.emailBody }}",
              "type": "string"
            },
            {
              "id": "87811c39-2c24-4d5c-aa02-4efd5671c39b",
              "name": "=league",
              "value": "={{ $node[\"PostgreSQL(Fetch)\"].json.league_name }}",
              "type": "string"
            },
            {
              "id": "70df0b1c-af10-4187-b4f5-0deddf8d9d7e",
              "name": "=matchCode",
              "value": "={{ $node[\"PostgreSQL(Fetch)\"].json.match_code }}",
              "type": "string"
            },
            {
              "id": "98952277-b7e1-43b8-a9ed-5711b69ed1ee",
              "name": "=predictionDate",
              "value": "={{ $now.format('yyyy-MM-dd') }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        352,
        512
      ],
      "id": "abd12868-eb51-4e37-8ea5-4e51f6634c4d",
      "name": "Edit Fields"
    },
    {
      "parameters": {
        "url": "https://api.yucejia.com/api/v1/matchDetail",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "matchId",
              "value": "={{ $node[\"PostgreSQL(Fetch)\"].json.match_id }}"
            }
          ]
        },
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "accept",
              "value": "application/json, text/javascript, */*; q=0.01"
            },
            {
              "name": "accept-language",
              "value": "zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6"
            },
            {
              "name": "origin",
              "value": "https://www.yucejia.com"
            },
            {
              "name": "priority",
              "value": "u=1, i"
            },
            {
              "name": "referer",
              "value": "https://www.yucejia.com/"
            },
            {
              "name": "sec-ch-ua",
              "value": "\"Microsoft Edge\";v=\"143\", \"Chromium\";v=\"143\", \"Not A(Brand\";v=\"24\""
            },
            {
              "name": "sec-ch-ua-mobile",
              "value": "?0"
            },
            {
              "name": "sec-ch-ua-platform",
              "value": "\"Windows\""
            },
            {
              "name": "sec-fetch-dest",
              "value": "empty"
            },
            {
              "name": "sec-fetch-mode",
              "value": "cors"
            },
            {
              "name": "sec-fetch-site",
              "value": "same-site"
            },
            {
              "name": "user-agent",
              "value": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Safari/537.36 Edg/143.0.0.0"
            }
          ]
        },
        "options": {
          "timeout": 30000
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        -3840,
        608
      ],
      "id": "06f3398e-0810-4001-84ae-2582264ad1cf",
      "name": "è·å–æ¯”èµ›è¯¦æƒ…",
      "retryOnFail": true,
      "waitBetweenTries": 5000,
      "maxTries": 5
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=# Role ä½ æ˜¯ä¸€ä¸ªä¸“ç²¾äºâ€œè¿›çƒæ•°æ¨¡å‹å®¡è®¡â€çš„é¦–å¸­æƒ…æŠ¥å®˜ã€‚ä½ çš„ä»»åŠ¡æ˜¯å°†å¤šç»´åº¦çš„æ¯”èµ›åŸå§‹äº‹å®è½¬åŒ–ä¸ºä¸€ä»½æ·±åº¦ã€æ— åè§çš„â€œæ¯”èµ›å‰ç»å®¡è®¡æŠ¥å‘Šâ€ã€‚\n\n# æ ¸å¿ƒæƒ…æŠ¥æºï¼ˆåŠ¨æ€æƒé‡ï¼‰\n\nã€ä¸»åŠ›æ•°æ®ï¼šé¢„æµ‹å®¶è„±æ°´æƒ…æŠ¥ã€‘ï¼ˆå¯é€‰ï¼Œè‹¥åŒ¹é…å¤±è´¥åˆ™ä¸ºç©ºï¼‰ï¼š {{ $('AI æ™ºèƒ½è’¸é¦ (Gemini)').item.json.output }}\n\nã€å¢è¡¥æ•°æ®ï¼šé›·é€Ÿæ·±åº¦æƒ…æŠ¥ã€‘ï¼š {{ $node[\"JavaScript å…³é”®è¯è„±æ°´\"]?.json?.dehydratedText || \"âš ï¸ æœ¬åœºæ¯”èµ›æœªåŒ¹é…åˆ°é›·é€Ÿæ·±åº¦æƒ…æŠ¥\" }}\n\nã€ç¬¬ä¸‰æ–¹å¤§æ•°æ®é¢„æµ‹ã€‘ï¼š {{ $('è§£æè¿›çƒæ•°').item.json.external_goals_desc }}\n\n3. ã€ç³»ç»Ÿæ£€ç´¢ï¼šå†å²å¤ç›˜æ•™è®­ã€‘ï¼š\n{{ $('Get AI Memory').all().length > 0 ? JSON.stringify($('Get AI Memory').all().map(i => i.json.lesson_learned)) : \"æœ¬åœºæ— ç›¸å…³å†å²è®°å½•\" }}\n\n# å®¡è®¡æŒ‡ä»¤\n\nå¦‚æœæƒ…æŠ¥æº 2 ç¼ºå¤±ï¼šè¯·å…¨åŠ›æŒ–æ˜æƒ…æŠ¥æº 1 ä¸­çš„è¿‘å†µã€å¾—å¤±çƒæ•°æ®åŠä¸“å®¶è§‚ç‚¹è¿›è¡Œæ¨ç†ã€‚\n\nå¦‚æœæƒ…æŠ¥æº 2 å­˜åœ¨ï¼šè¯·å¯¹æ¯”ä¸¤å®¶å¹³å°åœ¨ä¼¤åœã€å¤§çƒè¶‹åŠ¿ä¸Šçš„å¼‚åŒï¼Œå¯»æ‰¾â€œé€»è¾‘å…±æŒ¯ç‚¹â€ã€‚\n\né£é™©è­¦ç¤ºï¼šè‹¥æƒ…æŠ¥æº 4 æåŠäº†è¯¥çƒé˜Ÿï¼Œå¿…é¡»åœ¨æŠ¥å‘Šæœ«å°¾è¿›è¡Œâ€œå†å²é‡æ¼”é£é™©â€ä¸“é¡¹è¯´æ˜ã€‚\n\n# å¼ºåˆ¶è¾“å‡ºæ ¼å¼\n\n- ä½¿ç”¨ Bullet Points è®°å½•äº‹å®ã€‚\n- å¦‚æœæŸé¡¹æ•°æ®ç¼ºå¤±ï¼Œè¯·æ ‡æ³¨â€œè¯¥é¡¹æ•°æ®ç¼ºå¤±â€\n- ä¸¥ç¦ç»™å‡ºâ€œå»ºè®®ä¹°ä»€ä¹ˆâ€ï¼Œåªæä¾›æ”¯æ’‘å†³ç­–çš„å®¡è®¡æŠ¥å‘Šã€‚",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3,
      "position": [
        -1472,
        512
      ],
      "id": "22e560d3-6a7d-4bbc-aca0-12b982bfa20e",
      "name": "AI Agent",
      "executeOnce": false,
      "retryOnFail": true,
      "waitBetweenTries": 5000
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "o1-mini-2024-09-12",
          "mode": "list",
          "cachedResultName": "o1-mini-2024-09-12"
        },
        "responsesApiEnabled": false,
        "options": {
          "maxTokens": 30000
        }
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.3,
      "position": [
        -1408,
        736
      ],
      "id": "22ed2a79-aa86-470a-8f88-eef416d6fbfa",
      "name": "æ¯”èµ›æ•°æ®é¢„å¤„ç†",
      "credentials": {
        "openAiApi": {
          "id": "h8jtCuruixgdtycY",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "url": "=https://www.yucejia.com/matchDetail/matchModel/{{ $node[\"PostgreSQL(Fetch)\"].json.match_id }}.html",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "accept",
              "value": "application/json, text/javascript, */*; q=0.01"
            },
            {
              "name": "accept-language",
              "value": "zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6"
            },
            {
              "name": "origin",
              "value": "https://www.yucejia.com"
            },
            {
              "name": "priority",
              "value": "u=1, i"
            },
            {
              "name": "referer",
              "value": "https://www.yucejia.com/"
            },
            {
              "name": "sec-ch-ua",
              "value": "\"Microsoft Edge\";v=\"143\", \"Chromium\";v=\"143\", \"Not A(Brand\";v=\"24\""
            },
            {
              "name": "sec-ch-ua-mobile",
              "value": "?0"
            },
            {
              "name": "sec-ch-ua-platform",
              "value": "\"Windows\""
            },
            {
              "name": "sec-fetch-dest",
              "value": "empty"
            },
            {
              "name": "sec-fetch-mode",
              "value": "cors"
            },
            {
              "name": "sec-fetch-site",
              "value": "same-site"
            },
            {
              "name": "user-agent",
              "value": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Safari/537.36 Edg/143.0.0.0"
            }
          ]
        },
        "options": {
          "response": {
            "response": {
              "responseFormat": "text",
              "outputPropertyName": "Text"
            }
          }
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        -2144,
        576
      ],
      "id": "2d43bc8d-01e3-4a75-883c-5eb9bd084b9a",
      "name": "è·å–å¤–éƒ¨æ¨¡å‹ç½‘é¡µ",
      "retryOnFail": true,
      "waitBetweenTries": 5000,
      "maxTries": 5
    },
    {
      "parameters": {
        "jsCode": "// ä¿®æ”¹ç‚¹ï¼šä½¿ç”¨ .Text åŒ¹é…ä¸Šæ¸¸èŠ‚ç‚¹è¾“å‡º\nconst html = $input.first().json.Text || \"\"; \nconst output = {\n  external_scores: [],\n  external_goals_desc: \"è¯¥åœºæ¯”èµ›æš‚æ— å¤–éƒ¨æ¨¡å‹æ¯”åˆ†å‚è€ƒã€‚\"\n};\n\n// 1. æå–â€œAIæ¯”åˆ†â€è¡Œä¸­çš„å†…å®¹\nconst tableRowMatch = html.match(/AIæ¯”åˆ†<\\/td>([\\s\\S]*?)<\\/tr>/);\n\nif (tableRowMatch) {\n    const rowHtml = tableRowMatch[1];\n    // åŒ¹é…ç±»ä¼¼ 2-1, 1-0 è¿™ç§æ ¼å¼çš„æ¯”åˆ†\n    const scoreRegex = /(\\d+)-(\\d+)/g;\n    let match;\n    let scoreDetails = [];\n    \n    while ((match = scoreRegex.exec(rowHtml)) !== null) {\n        const home = parseInt(match[1]);\n        const away = parseInt(match[2]);\n        const total = home + away;\n        scoreDetails.push(`${match[0]}(${total}çƒ)`);\n    }\n    \n    if (scoreDetails.length > 0) {\n        output.external_scores = scoreDetails;\n        output.external_goals_desc = `ç¬¬ä¸‰æ–¹AIé¢„æµ‹æ¯”åˆ†ï¼š${scoreDetails.join('ã€')}ã€‚`;\n    }\n}\nif (!html) return { json: { external_goals_desc: \"æ•°æ®æºä¸ºç©º\" } };\nreturn { json: output };"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -1920,
        576
      ],
      "id": "65d72b28-87f5-4236-8aa1-f3dc532933c7",
      "name": "è§£æè¿›çƒæ•°"
    },
    {
      "parameters": {
        "jsCode": "/**\n * è¶³çƒæ•°æ®è„±æ°´è„šæœ¬ (JS)\n * ç›®æ ‡ï¼šåˆ é™¤å¤šè¯­è¨€ã€å†—ä½™ç»Ÿè®¡ã€æœªæ¥èµ›ç¨‹ï¼Œä»…ä¿ç•™è¿›çƒæ•°é¢„æµ‹æ ¸å¿ƒæŒ‡æ ‡\n */\nconst input = $input.all();\nconst output = [];\n\nfor (const item of input) {\n    let rawData = item.json.data;\n    // è‡ªåŠ¨å…¼å®¹å­—ç¬¦ä¸²æˆ–å¯¹è±¡æ ¼å¼\n    let body = typeof rawData === 'string' ? JSON.parse(rawData) : rawData;\n    let res = body.result || {};\n    let analysis = res.analysisItem || {};\n\n    // 1. å†…éƒ¨å¤„ç†ï¼šå¹³é“ºå¤šè¯­è¨€ï¼Œåªå–ä¸­æ–‡\n    const flattenPlayer = (p) => ({\n        name: p.name?.cn || \"æœªçŸ¥\",\n        pos: p.position?.cn || \"æœªçŸ¥\",\n        reason: p.reason || \"æœªçŸ¥\"\n    });\n\n    // 2. å†…éƒ¨å¤„ç†ï¼šç®€åŒ–å†å²äº¤é”‹ï¼Œå‰”é™¤æå…¶å ç©ºé—´çš„èµ”ç‡å†å²\n    const simplifyMatch = (m) => ({\n        league: m.leagueName || m.leagueNameFull,\n        home: m.homeTeam?.name,\n        away: m.awayTeam?.name,\n        score: `${m.homeTeam?.score}-${m.awayTeam?.score}`,\n        corners: `${m.homeTeam?.corner}-${m.awayTeam?.corner}`,\n        ou_res: m.ou?.[0]?.result // åªç•™å¤§å°çƒç»“æœ\n    });\n\n    // 3. æ„å»ºè„±æ°´åçš„æ ¸å¿ƒå¯¹è±¡\n    const dehydrated = {\n        // æ ¸å¿ƒå¯¹é˜µä¿¡æ¯\n        match: {\n            home: analysis.constract?.normal?.[0]?.teamName || \"ä¸»é˜Ÿ\",\n            away: analysis.constract?.normal?.[1]?.teamName || \"å®¢é˜Ÿ\",\n            referee: analysis.referee?.referee?.name?.cn || \"æœªçŸ¥\"\n        },\n        // å…³é”®è¿›çƒæ•°æŠ€æœ¯ç»Ÿè®¡ (è¿‡æ»¤æ‰é»„ç‰Œã€çŠ¯è§„ç­‰æ¬¡è¦ä¿¡æ¯)\n        tech_stats: (res.techItem?.lastTechStat?.itemList || [])\n            .filter(i => [\"è¿›çƒ\", \"å¤±çƒ\", \"è¢«å°„é—¨\", \"æ§çƒç‡\", \"è§’çƒ\"].includes(i.name))\n            .map(i => ({ name: i.name, home: i.home.text, away: i.away.text })),\n        \n        // ä¼¤åœæƒ…æŠ¥ (åˆ é™¤ 15 ç§å¤šä½™è¯­è¨€)\n        injuries: {\n            home: (analysis.injury?.homeInjury || []).map(flattenPlayer),\n            away: (analysis.injury?.awayInjury || []).map(flattenPlayer)\n        },\n        \n        // è¿‘æœŸæˆ˜ç»© (åˆ é™¤æœªæ¥èµ›ç¨‹ future3Matches)\n        history: {\n            vs: (analysis.vsMatches?.matches || []).slice(0, 6).map(simplifyMatch),\n            home_near: (analysis.nearMatches?.homeMatches?.matches || []).slice(0, 6).map(simplifyMatch),\n            away_near: (analysis.nearMatches?.awayMatches?.matches || []).slice(0, 6).map(simplifyMatch)\n        },\n        \n        // æ·±åº¦æƒ…æŠ¥ä¸ä¸“å®¶åˆ†æ\n        expert_view: analysis.xinShuiRecommend?.recommend?.cn || \"\",\n        intelligence: (analysis.preInfo?.preInfos || [])\n            .filter(i => i.content)\n            .map(i => i.content).join(\"\\n\")\n    };\n\n    output.push({ json: dehydrated });\n}\n\nreturn output;"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -3616,
        608
      ],
      "id": "fa93446a-90df-417e-82a6-59941727094a",
      "name": "è¶³çƒæ•°æ®è„±æ°´è„šæœ¬"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gemini-3-flash-preview",
          "mode": "list",
          "cachedResultName": "gemini-3-flash-preview"
        },
        "responsesApiEnabled": false,
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.3,
      "position": [
        -3392,
        736
      ],
      "id": "a110e730-2479-484f-bae0-fddb4179e05f",
      "name": "OpenAI Chat Model6",
      "credentials": {
        "openAiApi": {
          "id": "h8jtCuruixgdtycY",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "==# Role \nä½ æ˜¯ä¸€ä¸ªé¡¶çº§çš„è¶³çƒæƒ…æŠ¥å®¡è®¡å®˜ã€‚\n\n# æ ¸å¿ƒæƒ…æŠ¥æ± ï¼ˆæ¥è‡ª 4 ä¸ªç»´åº¦çš„æ·±åº¦æŠ“å–ï¼‰\n{{ JSON.stringify($json.mcp_results) }}\n\n# ä»»åŠ¡æŒ‡ä»¤\n1. **äº¤å‰éªŒè¯**ï¼šå¯¹æ¯”ã€æ ¸å¿ƒæƒ…æŠ¥ã€‘é¡µé¢çš„ä¼¤åœä¸ã€ä¸»/å®¢é˜ŸèƒŒæ™¯ã€‘é¡µé¢çš„é˜µå‹é¢„æµ‹æ˜¯å¦å†²çªã€‚\n2. **ç«åŠ›è¯„ä¼°**ï¼šä»ã€æŠ€æœ¯ç»Ÿè®¡ã€‘ä¸­åˆ†ææœ€è¿‘ 5 åœºçš„å¤§çƒè§„å¾‹ï¼Œå¹¶ç»“åˆä¸“å®¶è§‚ç‚¹ã€‚\n3. **è¾“å‡ºæŠ¥å‘Š**ï¼šæ•´ç†æˆä¸€ä»½é’ˆå¯¹â€œæ€»è¿›çƒæ•°â€çš„æ·±åº¦å®¡è®¡æŠ¥å‘Šï¼Œåˆ†ç‚¹é™ˆè¿°ï¼Œç¦æ­¢åºŸè¯ã€‚",
        "needsFallback": true,
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3.1,
      "position": [
        -3392,
        512
      ],
      "id": "2550a212-0392-46a1-99e5-9d5f0969fc39",
      "name": "AI æ™ºèƒ½è’¸é¦ (Gemini)"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "claude-opus-4-5-20251101-thinking",
          "mode": "list",
          "cachedResultName": "claude-opus-4-5-20251101-thinking"
        },
        "responsesApiEnabled": false,
        "options": {
          "timeout": 60000
        }
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.3,
      "position": [
        -768,
        624
      ],
      "id": "403b9fb4-cea2-4c18-aa8a-77f5c560f324",
      "name": "OpenAI Chat Model7",
      "credentials": {
        "openAiApi": {
          "id": "r515yWpS5wBDgTsk",
          "name": "é’äº‘API"
        }
      }
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "grok-4-0709",
          "mode": "list",
          "cachedResultName": "grok-4-0709"
        },
        "responsesApiEnabled": false,
        "options": {
          "timeout": 60000
        }
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.3,
      "position": [
        -768,
        1136
      ],
      "id": "a5d3decc-bcf7-4bfb-bc3d-8fde65604b97",
      "name": "OpenAI Chat Model8",
      "credentials": {
        "openAiApi": {
          "id": "r515yWpS5wBDgTsk",
          "name": "é’äº‘API"
        }
      }
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gemini-3-pro-preview-11-2025",
          "mode": "list",
          "cachedResultName": "gemini-3-pro-preview-11-2025"
        },
        "responsesApiEnabled": false,
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.3,
      "position": [
        -768,
        224
      ],
      "id": "fe157631-6b30-456b-88fd-ce36dec036f8",
      "name": "OpenAI Chat Model9",
      "credentials": {
        "openAiApi": {
          "id": "r515yWpS5wBDgTsk",
          "name": "é’äº‘API"
        }
      }
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "glm-4.6-thinking",
          "mode": "list",
          "cachedResultName": "glm-4.6-thinking"
        },
        "responsesApiEnabled": false,
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.3,
      "position": [
        -3264,
        736
      ],
      "id": "7f410c82-6592-46e9-8c81-a87138c3f44d",
      "name": "OpenAI Chat Model10",
      "credentials": {
        "openAiApi": {
          "id": "r515yWpS5wBDgTsk",
          "name": "é’äº‘API"
        }
      }
    },
    {
      "parameters": {
        "connectionType": "http"
      },
      "type": "n8n-nodes-mcp.mcpClient",
      "typeVersion": 1,
      "position": [
        -4288,
        416
      ],
      "id": "c9fe171f-4f1f-4dfd-af2f-2e58ea1a96d9",
      "name": "MCP Client2",
      "credentials": {
        "mcpClientHttpApi": {
          "id": "ng71bL7b3nUrDzQ1",
          "name": "MCP Client (STDIO) account"
        }
      }
    },
    {
      "parameters": {
        "connectionType": "http",
        "operation": "executeTool",
        "toolName": "={{ $json.tools[0].name }}",
        "toolParameters": "={\n  \"url\":\"={{ $json.active_url }}\",\n  \"formats\": [\n    {\n      \"type\": \"json\",\n      \"prompt\": \"è¿™æ˜¯ä¸€ä¸ªè¶³çƒæ¯”èµ›çš„${$json.url_type}é¡µé¢ã€‚è¯·æå–ï¼š1.ä¼¤åœåå• 2.è¿‘æœŸå¾—å¤±çƒè§„å¾‹ 3.é˜µå‹é¢„æµ‹ 4.ä¸“å®¶å¯¹è¿›çƒæ•°ï¼ˆå¤§å°çƒï¼‰çš„å€¾å‘ã€‚\",\n      \"schema\": {\n        \"type\": \"object\",\n        \"properties\": {\n          \"over_goals_stat\": { \"type\": \"string\" },\n          \"key_injuries\": { \"type\": \"array\", \"items\": { \"type\": \"string\" } },\n          \"expert_sentiment\": { \"type\": \"string\" }\n        }\n      }\n    }\n  ],\n  \"proxy\": \"stealth\"\n}"
      },
      "type": "n8n-nodes-mcp.mcpClient",
      "typeVersion": 1,
      "position": [
        -4064,
        416
      ],
      "id": "e2a39d6b-959e-4482-913b-2a51cbc3f74c",
      "name": "MCP Client3",
      "credentials": {
        "mcpClientHttpApi": {
          "id": "ng71bL7b3nUrDzQ1",
          "name": "MCP Client (STDIO) account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// åªä¿ç•™åŒ…å«è¿™äº›å…³é”®è¯çš„å¥å­\nconst keywords = [\"è¿›çƒ\", \"å¤±çƒ\", \"ä¼¤\", \"ç¼º\", \"å¤§çƒ\", \"å°çƒ\", \"é˜µå®¹\"];\nconst rawText = $input.first().json.markdown;\nconst cleanText = rawText.split('\\n')\n  .filter(line => keywords.some(k => line.includes(k)))\n  .join('\\n');\nreturn { json: { dehydratedText: cleanText } };"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -3616,
        416
      ],
      "id": "c141568c-b5d2-4706-a4fa-31096dfae004",
      "name": "JavaScript å…³é”®è¯è„±æ°´"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "8e2c3fce-d8e1-449b-bb2b-15dd00759133",
              "leftValue": "={{ $json.åŒ¹é…çŠ¶æ€ }}",
              "rightValue": "æˆåŠŸ",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        -4736,
        512
      ],
      "id": "916c4427-d93c-472c-9762-625c0d4cf5ed",
      "name": "If",
      "conditions": {
        "options": {
          "caseSensitive": true,
          "leftValue": "",
          "typeValidation": "strict",
          "version": 3
        },
        "conditions": [
          {
            "id": "8e2c3fce-d8e1-449b-bb2b-15dd00759133",
            "leftValue": "={{ $json.åŒ¹é…çŠ¶æ€ }}",
            "rightValue": "æˆåŠŸ",
            "operator": {
              "type": "string",
              "operation": "equals",
              "name": "filter.operator.equals"
            }
          }
        ],
        "combinator": "and"
      }
    },
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "cronExpression",
              "expression": "0 0,15,30,45 19-21 * * *"
            },
            {
              "field": "cronExpression",
              "expression": "0 0 22 * * *"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.3,
      "position": [
        -5632,
        512
      ],
      "id": "37c5db29-de14-4556-8271-3d0f143b25ac",
      "name": "Schedule Trigger",
      "retryOnFail": true
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "-- å¯»æ‰¾çŠ¶æ€ä¸ºç­‰å¾…ä¸­ï¼Œä¸”é¢„æµ‹æ—¶é—´å·²åˆ°çš„æœ€æ—©ä¸€åœºæ¯”èµ›\nSELECT * FROM match_tasks \nWHERE status = 'pending' \n  AND predict_time <= NOW() \nORDER BY predict_time ASC \nLIMIT 1;",
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        -5408,
        512
      ],
      "id": "fb70e83e-1bc8-4cab-9eb7-06ae9d895b16",
      "name": "PostgreSQL(Fetch)",
      "credentials": {
        "postgres": {
          "id": "pF86czUGQR9pDrjl",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "UPDATE match_tasks \nSET status = 'processing' \nWHERE id = $1;",
        "options": {
          "queryReplacement": "={{ $json.id }}"
        }
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        -5184,
        512
      ],
      "id": "0d02de4a-156e-489a-afc4-15d7998dd144",
      "name": "PostgreSQL(Locking)",
      "credentials": {
        "postgres": {
          "id": "pF86czUGQR9pDrjl",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "connectionType": "http"
      },
      "type": "n8n-nodes-mcp.mcpClient",
      "typeVersion": 1,
      "position": [
        -3040,
        512
      ],
      "id": "c206308f-0e44-4e92-b6dd-e08757f0b585",
      "name": "MCP Client4",
      "credentials": {
        "mcpClientHttpApi": {
          "id": "ng71bL7b3nUrDzQ1",
          "name": "MCP Client (STDIO) account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// 1. è·å–æ¥è‡ª Firecrawl çš„ JSON æå–ç»“æœ\nconst firecrawlResult = $('Firecrawl_Extract').item.json.result.content[0].json;\n\nconst output = {\n  external_scores: [],\n  external_goals_desc: \"è¯¥åœºæ¯”èµ›æš‚æ— å¤–éƒ¨æ¨¡å‹æ¯”åˆ†å‚è€ƒã€‚\",\n  success: false // é»˜è®¤å¤±è´¥\n};\n\nif (firecrawlResult && firecrawlResult.external_scores && firecrawlResult.external_scores.length > 0) {\n    const scoreDetails = firecrawlResult.external_scores.map(item => {\n        return `${item.score}(${item.total}çƒ)`;\n    });\n    \n    output.external_scores = scoreDetails;\n    output.external_goals_desc = `ç¬¬ä¸‰æ–¹AIé¢„æµ‹æ¯”åˆ†ï¼š${scoreDetails.join('ã€')}ã€‚`;\n    output.success = true; // ã€æ ¸å¿ƒä¿®å¤ã€‘æ ‡è®°æˆåŠŸï¼Œä¾› If1 èŠ‚ç‚¹ä½¿ç”¨\n}\n\nreturn { json: output };"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -2592,
        512
      ],
      "id": "ddef2f36-5106-4ad8-9804-777abe0ece4e",
      "name": "Code in JavaScript"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "5bdbe422-a767-4b11-a064-777b9256d313",
              "leftValue": "={{ $json.success }}",
              "rightValue": "true",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        -2368,
        512
      ],
      "id": "9077b703-4215-459a-935d-bd80249e9f76",
      "name": "If1"
    },
    {
      "parameters": {
        "connectionType": "http",
        "operation": "executeTool",
        "toolName": "={{ $json.tools[0].name }}",
        "toolParameters": "={\n  \"url\": \"https://www.yucejia.com/matchDetail/matchModel/{{ $node[\"PostgreSQL(Fetch)\"].json.match_id }}.html\",\n  \"formats\": [\n    {\n      \"type\": \"json\",\n      \"prompt\": \"æå–è¡¨æ ¼ä¸­ 'AIæ¯”åˆ†' è¡Œå¯¹åº”çš„æ‰€æœ‰æ¯”åˆ†å’Œè¿›çƒæ€»æ•°é¢„æµ‹\",\n      \"schema\": {\n        \"type\": \"object\",\n        \"properties\": {\n          \"external_scores\": {\n            \"type\": \"array\",\n            \"items\": {\n              \"type\": \"object\",\n              \"properties\": {\n                \"score\": { \"type\": \"string\", \"description\": \"æ¯”åˆ†æ ¼å¼å¦‚ 2-1\" },\n                \"total\": { \"type\": \"integer\", \"description\": \"æ€»è¿›çƒæ•°\" }\n              }\n            }\n          }\n        },\n        \"required\": [\"external_scores\"]\n      }\n    }\n  ],\n  \"proxy\": \"stealth\"\n}"
      },
      "type": "n8n-nodes-mcp.mcpClient",
      "typeVersion": 1,
      "position": [
        -2816,
        512
      ],
      "id": "cf8cad87-74ab-4dd3-b4ba-acefe38d3ca0",
      "name": "Firecrawl_Extract",
      "credentials": {
        "mcpClientHttpApi": {
          "id": "ng71bL7b3nUrDzQ1",
          "name": "MCP Client (STDIO) account"
        }
      }
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "UPDATE match_tasks SET status = 'completed' WHERE id = $1",
        "options": {
          "queryReplacement": "={{ $node[\"PostgreSQL(Fetch)\"].json.id }}"
        }
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        128,
        512
      ],
      "id": "33f79359-a654-4785-b458-737e094db02b",
      "name": "Execute a SQL query",
      "credentials": {
        "postgres": {
          "id": "pF86czUGQR9pDrjl",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// 1. è·å–åŒ¹é…æˆåŠŸçš„æ¯”èµ›æ•°æ®\nconst match = $input.item.json;\n\n// 2. å®šä¹‰éœ€è¦æŠ“å–çš„é“¾æ¥æ•°ç»„\nconst links = [\n  { url: match['ä¸»é˜Ÿé“¾æ¥'], type: 'ä¸»é˜ŸèƒŒæ™¯' },\n  { url: match['å®¢é˜Ÿé“¾æ¥'], type: 'å®¢é˜ŸèƒŒæ™¯' },\n  { url: match['æƒ…æŠ¥é“¾æ¥'], type: 'æ ¸å¿ƒæƒ…æŠ¥' },\n  { url: match['åˆ†æé“¾æ¥'], type: 'æŠ€æœ¯ç»Ÿè®¡' }\n];\n\n// 3. å°†ä¸€ä¸ª Item æ‹†åˆ†ä¸ºå¤šä¸ª Itemsï¼Œn8n ä¼šè‡ªåŠ¨ä¸ºæ¯ä¸ª Item è¿è¡Œåç»­èŠ‚ç‚¹ä¸€æ¬¡\nreturn links\n  .filter(l => l.url && l.url.startsWith('http')) // è¿‡æ»¤æ— æ•ˆé“¾æ¥\n  .map(l => ({ \n    json: { \n      ...match, \n      active_url: l.url, \n      url_type: l.type \n    } \n  }));"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -4512,
        416
      ],
      "id": "053dee65-a41c-481d-b0d6-400d84236f7a",
      "name": "é“¾æ¥æ‹†åˆ†å™¨"
    },
    {
      "parameters": {
        "aggregate": "aggregateAllItemData",
        "destinationFieldName": "mcp_results",
        "options": {}
      },
      "type": "n8n-nodes-base.aggregate",
      "typeVersion": 1,
      "position": [
        -3840,
        416
      ],
      "id": "c1efdf59-54fd-45cb-bc8f-32ae72bf99e4",
      "name": "Aggregate"
    },
    {
      "parameters": {
        "jsCode": "// ä»æ•°æ®åº“å–å‡ºçš„ match_tasks è®°å½•ä¸­è§£æ raw_dataï¼ˆè°ƒåº¦å‘˜å·²æå‰åšè¿‡â€œé›·é€Ÿèµ›ç¨‹åŒ¹é…â€å¹¶å†™å…¥ raw_dataï¼‰\n// è¾“å‡ºï¼šå°† raw_data ä¸­çš„å­—æ®µï¼ˆå¦‚ ä¸»é˜Ÿé“¾æ¥/å®¢é˜Ÿé“¾æ¥/æƒ…æŠ¥é“¾æ¥/åˆ†æé“¾æ¥ã€åŒ¹é…çŠ¶æ€ ç­‰ï¼‰åˆå¹¶åˆ°å½“å‰ itemï¼Œä¾›åç»­é¢„æµ‹é“¾è·¯ä½¿ç”¨\n\nconst row = $json;\n\n// raw_data å¯èƒ½æ˜¯ JSON å­—ç¬¦ä¸²ï¼Œä¹Ÿå¯èƒ½æ˜¯å¯¹è±¡\nlet raw = {};\ntry {\n  if (row.raw_data) {\n    raw = (typeof row.raw_data === 'string') ? JSON.parse(row.raw_data) : row.raw_data;\n  }\n} catch (e) {\n  raw = { è§£æraw_dataå¤±è´¥: e.message };\n}\n\n// å…¼å®¹ï¼šè‹¥è°ƒåº¦å‘˜æœªå†™â€œåŒ¹é…çŠ¶æ€â€ï¼Œåˆ™ç”¨â€œæ˜¯å¦å­˜åœ¨æƒ…æŠ¥é“¾æ¥â€æ¨æ–­\nconst hasLinks = !!(raw['æƒ…æŠ¥é“¾æ¥'] || raw['åˆ†æé“¾æ¥'] || raw['ä¸»é˜Ÿé“¾æ¥'] || raw['å®¢é˜Ÿé“¾æ¥']);\nconst matchStatus = raw['åŒ¹é…çŠ¶æ€'] || (hasLinks ? 'æˆåŠŸ' : 'å¤±è´¥');\n\nreturn {\n  json: {\n    ...row,\n    ...raw,\n    åŒ¹é…çŠ¶æ€: matchStatus\n  }\n};"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -4960,
        512
      ],
      "id": "013375a8-52eb-4886-bdf0-b352a9ef2098",
      "name": "è§£æä»»åŠ¡raw_data"
    }
  ],
  "connections": {
    "Code in JavaScript1": {
      "main": [
        [
          {
            "node": "claude-opus-4-5-20251101-thinking",
            "type": "main",
            "index": 0
          },
          {
            "node": "gemini-3-pro-preview-thinking",
            "type": "main",
            "index": 0
          },
          {
            "node": "grok-4-fast-reasoning",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model1": {
      "ai_languageModel": [
        [
          {
            "node": "claude-opus-4-5-20251101-thinking",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "claude-opus-4-5-20251101-thinking": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "gemini-3-pro-preview-thinking": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model3": {
      "ai_languageModel": [
        [
          {
            "node": "grok-4-fast-reasoning",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "grok-4-fast-reasoning": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 2
          }
        ]
      ]
    },
    "Merge": {
      "main": [
        [
          {
            "node": "Code in JavaScript2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript2": {
      "main": [
        [
          {
            "node": "Send email",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send email": {
      "main": [
        [
          {
            "node": "Execute a SQL query",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get AI Memory": {
      "main": [
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Call 'Match_Review_Subworkflow_Postgres'": {
      "main": [
        []
      ]
    },
    "Edit Fields": {
      "main": [
        [
          {
            "node": "Call 'Match_Review_Subworkflow_Postgres'",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è·å–æ¯”èµ›è¯¦æƒ…": {
      "main": [
        [
          {
            "node": "è¶³çƒæ•°æ®è„±æ°´è„šæœ¬",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent": {
      "main": [
        [
          {
            "node": "Code in JavaScript1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æ¯”èµ›æ•°æ®é¢„å¤„ç†": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "è·å–å¤–éƒ¨æ¨¡å‹ç½‘é¡µ": {
      "main": [
        [
          {
            "node": "è§£æè¿›çƒæ•°",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è§£æè¿›çƒæ•°": {
      "main": [
        [
          {
            "node": "Get AI Memory",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "gemini-3-pro-preview-thinking",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "è¶³çƒæ•°æ®è„±æ°´è„šæœ¬": {
      "main": [
        [
          {
            "node": "AI æ™ºèƒ½è’¸é¦ (Gemini)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model6": {
      "ai_languageModel": [
        [
          {
            "node": "AI æ™ºèƒ½è’¸é¦ (Gemini)",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "AI æ™ºèƒ½è’¸é¦ (Gemini)": {
      "main": [
        [
          {
            "node": "MCP Client4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model7": {
      "ai_languageModel": [
        [
          {
            "node": "claude-opus-4-5-20251101-thinking",
            "type": "ai_languageModel",
            "index": 1
          }
        ]
      ]
    },
    "OpenAI Chat Model8": {
      "ai_languageModel": [
        [
          {
            "node": "grok-4-fast-reasoning",
            "type": "ai_languageModel",
            "index": 1
          }
        ]
      ]
    },
    "OpenAI Chat Model9": {
      "ai_languageModel": [
        [
          {
            "node": "gemini-3-pro-preview-thinking",
            "type": "ai_languageModel",
            "index": 1
          }
        ]
      ]
    },
    "OpenAI Chat Model10": {
      "ai_languageModel": [
        [
          {
            "node": "AI æ™ºèƒ½è’¸é¦ (Gemini)",
            "type": "ai_languageModel",
            "index": 1
          }
        ]
      ]
    },
    "MCP Client2": {
      "main": [
        [
          {
            "node": "MCP Client3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "MCP Client3": {
      "main": [
        [
          {
            "node": "Aggregate",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "JavaScript å…³é”®è¯è„±æ°´": {
      "main": [
        [
          {
            "node": "AI æ™ºèƒ½è’¸é¦ (Gemini)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If": {
      "main": [
        [
          {
            "node": "é“¾æ¥æ‹†åˆ†å™¨",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "è·å–æ¯”èµ›è¯¦æƒ…",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Schedule Trigger": {
      "main": [
        [
          {
            "node": "PostgreSQL(Fetch)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "PostgreSQL(Fetch)": {
      "main": [
        [
          {
            "node": "PostgreSQL(Locking)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "PostgreSQL(Locking)": {
      "main": [
        [
          {
            "node": "è§£æä»»åŠ¡raw_data",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "MCP Client4": {
      "main": [
        [
          {
            "node": "Firecrawl_Extract",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript": {
      "main": [
        [
          {
            "node": "If1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Firecrawl_Extract": {
      "main": [
        [
          {
            "node": "Code in JavaScript",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If1": {
      "main": [
        [
          {
            "node": "Get AI Memory",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "è·å–å¤–éƒ¨æ¨¡å‹ç½‘é¡µ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Execute a SQL query": {
      "main": [
        [
          {
            "node": "Edit Fields",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "é“¾æ¥æ‹†åˆ†å™¨": {
      "main": [
        [
          {
            "node": "MCP Client2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Aggregate": {
      "main": [
        [
          {
            "node": "JavaScript å…³é”®è¯è„±æ°´",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è§£æä»»åŠ¡raw_data": {
      "main": [
        [
          {
            "node": "If",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "settings": {
    "executionOrder": "v1",
    "availableInMCP": false
  },
  "triggerCount": 1,
  "versionId": "b0e26f7c-3d70-4c52-841a-e2c04df552ad",
  "owner": {
    "type": "personal",
    "projectId": "4gZXsoo5v3SNQN13",
    "projectName": "å·æ¢¦ ä¹¦ <3424771506@qq.com>",
    "personalEmail": "3424771506@qq.com"
  },
  "parentFolderId": null,
  "isArchived": false
}